function ValidarDatosExcel(){if($("#btnCargarExcel").prop("disabled",!0),$("#excelFile")[0].files[0]!=null){var n=new FormData;n.append("file",$("#excelFile")[0].files[0]);$.ajax({type:"POST",url:"/Independiente/ValidarDatosExcel",data:n,cache:!1,contentType:!1,processData:!1,success:function(n){CargarAlertas(frmHome);n.isEverythingGood&&(loadTable(n.lista),$("#btnCargarExcel").prop("disabled",!1))},error:function(){CargarAlertas(frmHome)},complete:function(){$("#formImport")[0].reset();$(".custom-file-label").html("Seleccionar Archivo");$("#btnCargarExcel").prop("disabled",!1)}})}else Danger("Debe cargar un archivo."),$("#btnCargarExcel").prop("disabled",!1)}function loadTable(n){$("#TablaPlanPagosImpuestos").load("/Independiente/PagosImpuestosTable/",{Lista:n},function(n,t){t=="success"})}function ObjPersona(){return{IdPersona:null,Ganancias_C1:null,Ganancias_C2:null,Ganancias_C3:null,Ganancias_C4:null,Ganancias_C5:null,SubTotalGanancias:null,Bienes_C1:null,Bienes_C2:null,Bienes_C3:null,Bienes_C4:null,Bienes_C5:null,SubTotalBienes:null,Total:null}}function GetDataSociosExSocios(){var n=[];return $("#planPagosTable tbody tr[data-type='Socio']").each(function(t,i){var r=ObjPersona();r.IdPersona=i.id;r.Ganancias_C1=$("#ImporteC1_Ganancias_"+i.id).attr("data-val");r.Ganancias_C2=$("#ImporteC2_Ganancias_"+i.id).attr("data-val");r.Ganancias_C3=$("#ImporteC3_Ganancias_"+i.id).attr("data-val");r.Ganancias_C4=$("#ImporteC4_Ganancias_"+i.id).attr("data-val");r.Ganancias_C5=$("#ImporteC5_Ganancias_"+i.id).attr("data-val");r.SubTotalGanancias=$("#SubTotalGanancias_"+i.id).attr("data-val");r.Bienes_C1=$("#ImporteC1_Bienes_"+i.id).attr("data-val");r.Bienes_C2=$("#ImporteC2_Bienes_"+i.id).attr("data-val");r.Bienes_C3=$("#ImporteC3_Bienes_"+i.id).attr("data-val");r.Bienes_C4=$("#ImporteC4_Bienes_"+i.id).attr("data-val");r.Bienes_C5=$("#ImporteC5_Bienes_"+i.id).attr("data-val");r.SubTotalBienes=$("#SubTotalBienes_"+i.id).attr("data-val");r.Total=$("#ImporteTotal_"+i.id).attr("data-val");n.push(r)}),n}function GuardarPlanPagoImpuestos(){var n=GetDataSociosExSocios();n.length!=0?$.post("/Independiente/GuardarPlanPagoImpuestos",{Data:n}).done(function(n){n.IsEverythingGood==!0}).always(function(){CargarAlertas(frmHome)}):Danger("Debe cargar un archivo excel antes de guardar.")}