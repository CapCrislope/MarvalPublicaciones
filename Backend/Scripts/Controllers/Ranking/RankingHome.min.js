function IniciarTablaRanking(){$.fn.dataTable.ext.errMode="none";$("#TablaRanking").on("error.dt",function(){CargarAlertas(frmReconocimientos)});var n=$("#TablaRanking").dataTable({dom:"Blfrtip",buttons:[{text:'<span class="iconoExcel" aria-hidden="true" title="Exportar a Excel"><\/span>',className:"btn btn-default btn-sm btn-imagen space1",action:function(){GenerarExcelCompletoRanking()}},],order:[[0,"asc"],[2,"desc"]],sAjaxSource:"/Ranking/LlenarJSONGrilla",sServerMethod:"POST",aoColumns:[{data:"Order",sWidth:"5%"},{data:"Title",sWidth:"40%"},{data:"Year",sWidth:"5%"},{data:"Areas",sWidth:"40%"},{data:null,sWidth:"10%",orderable:!1,sClass:"der",render:function(n,t,i){return renderBotones(i)}}],bAutoWidth:!1,bProcessing:!0,pageLength:25,fnServerData:function(n,t,i){$.ajax({dataType:"json",type:"POST",url:n,data:$("#formBusquedaRanking").serialize(),success:i})},fnDrawCallback:function(){return eventHandlerBotonesGrilla()}})}function renderBotones(n){return html="",html+='<button type="button" class="btnVisible btn '+(n.Visible===1?"btn-success":"btn-danger")+' btn-xs space1" data-IdReconocimiento='+n.Id+' value="'+n.Visible+'">                <span class="glyphicon glyphicon-off"><\/span>            <\/button>',html+='<button type="button" class="btnEditar btn btn-default btn-xs space1" data-IdReconocimiento='+n.Id+'>                <span class="glyphicon glyphicon-edit"><\/span>            <\/button>',html+='<button type="button" id="enc'+n.Id+'" class="btnEliminar btn btn-default btn-xs" data-IdReconocimiento='+n.Id+' data-toggle="confirmation">                <span class="glyphicon glyphicon-remove"><\/span>            <\/button>'}function eventHandlerBotonesGrilla(){$(".dt-button").removeClass("dt-button");$(".btnVisible").on("click",function(){var n=$(this);$.ajax({type:"POST",dataType:"json",url:"/Ranking/SetVisible",data:{id:n.data("idreconocimiento"),state:n.val()==="1"?"0":"1"}}).success(function(){n.val()==="1"?(n.val(0),n.removeClass("btn-success").addClass("btn-danger")):(n.val(1),n.removeClass("btn-danger").addClass("btn-success"))}).always(function(){CargarAlertas(frmReconocimientos)})});$(".btnEditar").on("click",function(){CargarModalRanking($(this).attr("data-IdReconocimiento"))});$('[data-toggle="confirmation"]').confirmation({singleton:!0,placement:"left",title:"Eliminar",btnOkLabel:"Si",btnCancelLabel:"No",onConfirm:function(){return borrarRegistro($(this).data("idreconocimiento"))}})}function borrarRegistro(n){$.ajax({dataType:"json",type:"POST",url:"/Ranking/EliminarRankingById",data:{id:n}}).done(function(n){n.IsEverythingGood?ReloadTable("TablaRanking",!1):n.IsRedirect&&(window.location.href="/Home/Login")}).always(function(){CargarAlertas(frmReconocimientos)})}function AltaRanking(){CargarModalRanking("")}function CargarPnlBusqueda(){$("#pnlBusqueda").load("/Ranking/Busqueda",function(n,t){t=="success"||CargarAlertas(frmReconocimientos)})}function MostrarPnlBusqueda(){$("#pnlContainerBusqueda").slideToggle(500,function(){var n=$(".desplegableFiltros > span");n.hasClass("glyphicon-chevron-down")?n.removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"):n.removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")})}function CargarModalRanking(n){$("#dialog").load("/Ranking/Modal",{id:n},function(n,t){t=="success"&&$("#dialog").modal("show")})}function GenerarExcelCompletoRanking(){$("#TablaRanking td.dataTables_empty").length==0?$.post("/Ranking/GenerarExcelCompletoRanking",$("#formBusquedaRanking").serialize()).success(function(n){n.IsEverythingGood&&(window.location="/Ranking/ExportarExcelCompleto?token="+n.Token)}).always(function(){CargarAlertas(frmReconocimientos)}):Danger("Debe haber, por lo menos, 1 registro en la grilla.")}var frmReconocimientos="Reconocimientos";