function ModalRechazarBonosRetiros(){$("#dialog").load("/Finanzas/ModalRechazarBonosRetiros",function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmHome)})}function RechazarBonosRetiros(){var n=$("#notaRevision").val();n!=""?n.length<=500?$.post("/Finanzas/RechazarBonosRetiros",{NotaRevision:n}).done(function(n){n.isEverythingGood==!0&&($("#dialog").modal("hide"),CargarMenu())}).always(function(){CargarAlertas(frmHome)}):Danger("La nota de revisión puede contener hasta 500 caracteres."):Danger("Para rechazar los Bonos/Retiros, es obligatorio que cargue una nota de revisión.")}function EdicionDatos(n){var f=$("#"+n).attr("data-type"),e=$("#ImporteImpuestos_"+n).attr("data-val"),t=$("#ImporteImpuestos_"+n).attr("data-modif"),o=$("#ImporteRetenciones_"+n).attr("data-val"),i=$("#ImporteRetenciones_"+n).attr("data-modif"),r=e,u=o;t!=""&&(r=t);i!=""&&(u=i);$("#dialog").load("/Finanzas/ModalEdicionImpuestosRetenciones",{IdSocio:n,EsSocio:f,Impuestos:r,Retenciones:u},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmHome)})}function EdicionImpuestosRetenciones(){var t=$("#FormEdicionImpuestosRetenciones").serializeArray(),n=t[0].value,e=t[1].value,i=parseInt(t[2].value),r=parseInt(t[3].value),u=0,f=0;i>=0&&r>=0?($("#ImporteRetenciones_"+n).text("$ "+r.toLocaleString()),$("#ImporteRetenciones_"+n).attr("data-modif",r),$("#ImporteImpuestos_"+n).text("$ "+i.toLocaleString()),$("#ImporteImpuestos_"+n).attr("data-modif",i),ObtenerSaldoInicial(n,e,CalcularSumaImpuestos),u=parseInt($("#Importe_TotalImpuestosSocios").attr("data-val"))+parseInt($("#Importe_TotalImpuestosExSocios").attr("data-val")),$("#ImporteSumaTotalImpuestos").attr("data-val",u),$("#ImporteSumaTotalImpuestos").text("$ "+u.toLocaleString()),f=parseInt($("#Importe_TotalRetencionesSocios").attr("data-val"))+parseInt($("#Importe_TotalRetencionesExSocios").attr("data-val")),$("#ImporteSumaTotalRetenciones").attr("data-val",f),$("#ImporteSumaTotalRetenciones").text("$ "+f.toLocaleString()),TotalSaldoInicial=parseInt($("#Importe_TotalSaldoInicialSocios").attr("data-val"))+parseInt($("#Importe_TotalSaldoInicialExSocios").attr("data-val")),$("#ImporteSumaTotalSaldoInicial").attr("data-val",TotalSaldoInicial),$("#ImporteSumaTotalSaldoInicial").text("$ "+TotalSaldoInicial.toLocaleString()),$("#dialog").modal("hide"),Success("Se modificó correctamente los valores de Retenciones e Impuestos del Socio/ExSocio: "+n)):Danger("Los campos Retenciones e Impuestos son obligatorios.")}function ObtenerSaldoInicial(n,t,i){var u=parseInt($("#Importe_"+n).attr("data-val")),f=parseInt($("#ImporteRetiro_"+n).attr("data-val")),e=parseInt($("#ImporteBono_"+n).attr("data-val")),o=parseInt($("#ImporteImpuestos_"+n).attr("data-modif")),s=parseInt($("#ImporteRetenciones_"+n).attr("data-modif")),h=parseInt($("#ImporteAjusteEjercicioAnterior_"+n).attr("data-val")),r=u-f-e-o-s-h;$("#ImporteSaldoInicial_"+n).attr("data-modif",r);$("#ImporteSaldoInicial_"+n).text("$ "+r.toLocaleString());i(t,CalcularSumaRetenciones)}function CalcularSumaImpuestos(n,t){var i=0;$("#ImportesSocioTable tbody tr[data-type='"+n+"'] ").find("div[id^='ImporteImpuestos_']").each(function(n,t){var r=t.id;i=$("#"+r).attr("data-modif")==""?parseInt($("#"+r).attr("data-val"))+i:parseInt($("#"+r).attr("data-modif"))+i});n=="Socio"?($("#Importe_TotalImpuestosSocios").attr("data-val",i),$("#Importe_TotalImpuestosSocios").text("$ "+i.toLocaleString())):($("#Importe_TotalImpuestosExSocios").attr("data-val",i),$("#Importe_TotalImpuestosExSocios").text("$ "+i.toLocaleString()));t(n,CalcularSumaSaldoInicial)}function CalcularSumaRetenciones(n,t){var i=0;$("#ImportesSocioTable tbody tr[data-type='"+n+"'] ").find("div[id^='ImporteRetenciones_']").each(function(n,t){var r=t.id;i=$("#"+r).attr("data-modif")==""?parseInt($("#"+r).attr("data-val"))+i:parseInt($("#"+r).attr("data-modif"))+i});n=="Socio"?($("#Importe_TotalRetencionesSocios").attr("data-val",i),$("#Importe_TotalRetencionesSocios").text("$ "+i.toLocaleString())):($("#Importe_TotalRetencionesExSocios").attr("data-val",i),$("#Importe_TotalRetencionesExSocios").text("$ "+i.toLocaleString()));t(n)}function CalcularSumaSaldoInicial(n){var t=0;$("#ImportesSocioTable tbody tr[data-type='"+n+"'] ").find("div[id^='ImporteSaldoInicial_']").each(function(n,i){var r=i.id;t=$("#"+r).attr("data-modif")==""?parseInt($("#"+r).attr("data-val"))+t:parseInt($("#"+r).attr("data-modif"))+t});n=="Socio"?($("#Importe_TotalSaldoInicialSocios").attr("data-val",t),$("#Importe_TotalSaldoInicialSocios").text("$ "+t.toLocaleString())):($("#Importe_TotalSaldoInicialExSocios").attr("data-val",t),$("#Importe_TotalSaldoInicialExSocios").text("$ "+t.toLocaleString()))}function ObjPersona(){return{PersonaId:null,Impuestos:null,ImpuestosModif:null,Retenciones:null,RetencionesModif:null,SaldoInicialS:null,SaldoInicialModif:null}}function GetDataSociosExSocios(n){var t=[];return $("#ImportesSocioTable tbody tr[data-type='"+n+"']").each(function(n,i){var r=ObjPersona(),u=i.id,f=$("#ImporteImpuestos_"+i.id).attr("data-val"),e=$("#ImporteImpuestos_"+i.id).attr("data-modif"),o=$("#ImporteRetenciones_"+i.id).attr("data-val"),s=$("#ImporteRetenciones_"+i.id).attr("data-modif"),h=$("#ImporteSaldoInicial_"+i.id).attr("data-val"),c=$("#ImporteSaldoInicial_"+i.id).attr("data-modif");r.PersonaId=u;r.Impuestos=f;r.ImpuestosModif=e;r.Retenciones=o;r.RetencionesModif=s;r.SaldoInicialS=h;r.SaldoInicialModif=c;t.push(r)}),t}function GuardarCalculosIniciales(){var n={Socios:GetDataSociosExSocios("Socio"),ExSocios:GetDataSociosExSocios("ExSocio"),Modo:$("#Modo").val()};$.post("/Finanzas/GuardarValoresIniciales",{Data:n}).done(function(n){n.isEverythingGood==!0&&(CargarMenu(),CargarEstadoProceso())}).always(function(){CargarAlertas(frmHome)})}