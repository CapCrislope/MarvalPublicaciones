/*! politespace - v1.0.2 - 2017-07-06
Politely add spaces to input values to increase readability (credit card numbers, phone numbers, etc).
 * https://github.com/filamentgroup/politespace
 * Copyright (c) 2017 Filament Group (@filamentgroup)
 * MIT License */
(function(n){"use strict";function r(n){for(var i in t)if(!!n.match(t[i]))return i;return-1}var i={MASTERCARD:"MASTERCARD",VISA:"VISA",DISCOVER:"DISCOVER",AMEX:"AMEX",JCB:"JCB"},t={};t[i.MASTERCARD]=/^(222[1-9]|22[3-9]|2[3-6]|27[01]|2720|5[1-5])/;t[i.VISA]=/^4/;t[i.DISCOVER]=/^6(011|22(12[6-9]|1[3-9]|[2-8]|9[0-1]|92[0-5])|4[4-9]|5)/;t[i.AMEX]=/^3[47]/;t[i.JCB]=/^35/;r.KEYS=i;r.TYPES=t;n.CreditableCardType=r})(typeof global!="undefined"?global:this),function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof module=="object"&&module.exports?module.exports=function(t,i){return i===undefined&&(i=typeof window!="undefined"?require("jquery"):require("jquery")(t)),n(i),i}:n(jQuery)}(function(n){"use strict";var r=typeof window!="undefined"?window:this,t=function(t){if(!t)throw new Error("Politespace requires an element argument.");if(t.getAttribute&&!r.operamini){this.element=t;this.$element=n(t);this.delimiter=this.$element.attr("data-politespace-delimiter")||".";this.decimalMark=this.$element.attr("data-politespace-decimal-mark")||"";this.reverse=this.$element.is("[data-politespace-reverse]");this.strip=this.$element.attr("data-politespace-strip");this.groupLength=this.$element.attr("data-politespace-grouplength")||3;this.prefix=this.$element.attr("data-politespace-prefix")||"";var i=this.$element.attr("data-politespace-proxy-anchor");this.$proxyAnchor=this.$element;this.$proxy=null;i&&(this.$proxyAnchor=this.$element.closest(i))}},i;t.prototype._divideIntoArray=function(n){for(var i=(""+this.groupLength).split(","),o=i.length===1,u=[],t=0,f,e,r;i.length&&t<n.length;)f=o?i[0]:i.shift()||n.length-t,r=Math.min(parseInt(f,10),n.length-t),e=this.reverse?-1*(r+t):t,u.push(n.substr(e,r)),t+=r;return this.reverse&&u.reverse(),u};t.prototype.format=function(n){var i,t=this.unformat(n),r;return this.strip&&(t=t.replace(new RegExp(this.strip,"g"),"")),r="",this.decimalMark&&(i=t.split(this.decimalMark),r=i.length>1?this.decimalMark+i[1]:"",t=i[0]),this.prefix+this._divideIntoArray(t).join(this.delimiter)+r};t.prototype.trimMaxlength=function(n){var t=this.element.getAttribute("maxlength");return t&&(n=n.substr(0,t)),n};t.prototype.getValue=function(){return this.trimMaxlength(this.element.value)};t.prototype.update=function(){this.element.value=this.useProxy()||this.$element.attr("type")==="password"?this.getValue():this.format(this.getValue())};t.prototype.unformat=function(n){var t=this.delimiter;return t=="."&&(t="\\."),n.replace(new RegExp(t,"g"),"")};t.prototype.reset=function(){this.element.value=this.unformat(this.element.value)};t.prototype.useProxy=function(){var n=this.$element.attr("pattern"),t=this.$element.attr("type");return t==="number"||(n?!new RegExp("^"+n+"$").test(this.delimiter):!1)};t.prototype.updateProxy=function(){if(this.useProxy()&&this.$proxy.length){var n=this.format(this.getValue()),t=this.element.offsetWidth;this.$proxy.html(n);t&&this.$proxy.css("width",t+"px");this.$proxy.closest(".politespace-proxy")[n?"addClass":"removeClass"]("notempty")}};t.prototype.createProxy=function(){function i(t,i){for(var u=0,f=n(t),r=0,e=i.length;r<e;r++)u+=parseFloat(f.css(i[r]));return u}if(this.useProxy()){var t=n("<div>").addClass("politespace-proxy active"),r=this.$proxyAnchor.next(),u=this.$proxyAnchor.parent();this.$proxy=n("<div>").attr("aria-hidden","true").addClass("politespace-proxy-val").css({font:this.$element.css("font"),"padding-left":i(this.element,["padding-left","border-left-width"])+"px","padding-right":i(this.element,["padding-right","border-right-width"])+"px",top:i(this.element,["padding-top","border-top-width","margin-top"])+"px"});t.append(this.$proxy);t.append(this.$proxyAnchor);r.length?t.insertBefore(r):u.append(t);this.updateProxy()}};t.prototype.setGroupLength=function(n){this.groupLength=n;this.$element.attr("data-politespace-grouplength",n)};i="politespace";n.fn[i]=function(){return this.each(function(){var u=n(this),r;u.data(i)||(r=new t(this),r.useProxy()&&r.createProxy(),u.bind("politespace-hide-proxy",function(){n(this).closest(".politespace-proxy").removeClass("active")}).bind("politespace-show-proxy",function(){n(this).closest(".politespace-proxy").addClass("active");r.update();r.updateProxy()}).bind("input keydown",function(){n(this).trigger("politespace-input");r.updateProxy()}).bind("blur",function(){n(this).trigger("politespace-beforeblur");r.update();r.useProxy()&&n(this).trigger("politespace-show-proxy")}).bind("focus",function(){n(this).trigger("politespace-hide-proxy");r.reset()}).data(i,r).trigger("politespace-init"),r.update(),r.updateProxy())})};n(document).bind("politespace-init politespace-input",function(t){var i=n(t.target);if(i.is("[data-politespace-creditcard]")){var e=i.data("politespace"),o=i.val(),f=i.is("[data-politespace-creditcard-maxlength]"),u=r.CreditableCardType(o);u==="AMEX"?(e.setGroupLength(f?"4,6,5":"4,6,"),f&&i.attr("maxlength",15)):(u==="DISCOVER"||u==="VISA"||u==="MASTERCARD"||u==="JCB")&&(e.setGroupLength(f?"4,4,4,4":"4"),f&&i.attr("maxlength",16))}}),function(n,t){function u(n){var i=t(n),r=i.val();i.val(r.replace(/^1/,""))}var i="politespace-us-telephone-maxlength",r="politespace-beforeblur.politespace-us-telephone";t(document).bind("politespace-init",function(n){var f=t(n.target),e;if(f.is("[data-politespace-us-telephone]")&&(e=f.attr("maxlength"),e)){f.data(i,parseInt(e,10));u(f[0]);f.off(r).on(r,function(){t(this).attr("maxlength",f.data(i));u(this)})}});t(document).bind("politespace-input",function(n){var r=t(n.target);r.is("[data-politespace-us-telephone]")&&r.val().indexOf("1")===0&&r.attr("maxlength",r.data(i)+1)})}(typeof global!="undefined"?global:this,jQuery);r.Politespace=t});