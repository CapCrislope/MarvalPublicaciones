function InicializarTablaEdicionEvento(){$.fn.dataTable.ext.errMode="none";$("#EventoTable").on("error.dt",function(){CargarAlertas(frmEvento)});var n=$("#EventoTable").dataTable({dom:"lfrtip",sAjaxSource:"/Evento/LlenarJSONGrillaEventoEdicion",sServerMethod:"POST",columnDefs:[{type:"fecha",targets:2}],aoColumns:[{data:"TituloEvento",sWidth:"28%"},{data:"TituloEdicion",sWidth:"40%"},{data:"FechaEdicion",sWidth:"10%"},{data:"EdicionId",sClass:"der",orderable:!1,sWidth:"27%",render:function(n,t,i){return BotoneraEdicionEvento(i)}}],bAutoWidth:!1,pageLength:50,language:{select:{rows:". %d filas seleccionadas"}},fnDrawCallback:function(){FuncionesBotoneraGrillaEdicionEvento()}})}function BotoneraEdicionEvento(n){var t="";return t+=n.Visible==1?'        <button type="button" class="habilitadoDialog btn btn-success btn-xs" data-clientid="'+n.EdicionId+'" title="Habilitado" value="true">             <span class="glyphicon glyphicon-off" aria-hidden="true"><\/span>         <\/button>':'        <button type="button" class="habilitadoDialog btn btn-danger btn-xs" data-clientid="'+n.EdicionId+'" title="DesHabilitado" value="false">             <span class="glyphicon glyphicon-off" aria-hidden="true"><\/span>         <\/button>',t+('        <button type="button" class="addVideo btn btn-default btn-xs" data-clientid="'+n.EdicionId+'" title="Agregar contenido" >             <span class="glyphicon glyphicon-facetime-video" aria-hidden="true"><\/span>         <\/button>         <button type="button" class="addContenidoExtra btn btn-default btn-xs" data-clientid="'+n.EdicionId+'" title="Agregar contenido extra">             <span class="glyphicon glyphicon-plus" aria-hidden="true"><\/span>         <\/button>         <button type="button" class="btnAgenda btn btn-default btn-xs" data-clientid="'+n.EdicionId+'" title="Abrir agenda" >             <span class="glyphicon glyphicon-calendar" aria-hidden="true"><\/span>         <\/button>         <button type="button" class="editDialog btn btn-default btn-xs" data-clientid="'+n.EdicionId+'" title="Editar">             <span class="glyphicon glyphicon-edit" aria-hidden="true"><\/span>         <\/button>         <button type="button" id="mat_'+n.EdicionId+'" class="btn btn-default btn-xs" data-toggle="confirmation" data-placement="left" data-singleton="true" data-on-confirm="EliminarEdicionEvento" data-title="¿Está seguro?" onclick="SelEdicionEvento('+n.EdicionId+');">             <span class="glyphicon glyphicon-remove" aria-hidden="true">             <\/span>         <\/button>        <a role="button" id="'+n.EdicionId+'" class="btn btn-default btn-xs" target="_blank" href="'+web_url_evento+n.Slug+"-"+n.EdicionId+'">             <span class="glyphicon glyphicon-globe" aria-hidden="true">             <\/span>         <\/a>')}function FuncionesBotoneraGrillaEdicionEvento(){$("[data-toggle=confirmation]").confirmation();$(".editDialog").off().on("click",function(){ModalEdicionEvento($(this).data("clientid"))});$(".adjunto").off().on("click",function(){ModalAdjuntoEvento($(this).data("clientid"))});$(".habilitadoDialog").off().on("click",function(){HabilitarEdicionEvento($(this).data("clientid"),$(this).attr("value"))});$(".addVideo").off().on("click",function(){ModalContenido($(this).data("clientid"))});$(".btnAgenda").off().on("click",function(){ModalAgenda($(this).data("clientid"))});$(".addContenidoExtra").off().on("click",function(){ModalContenidoExtra($(this).data("clientid"))})}function ModalContenido(n){$("#dialog").load("/Evento/ModalContenidoEvento",{idEvento:n},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmEvento)})}function HabilitarEdicionEvento(n,t){return $.post("/Evento/HabilitarEdicionEvento/",{IdEdicionEvento:n,Habilitado:t}).success(function(n){n.IsEverythingGood==!0&&ReloadTable("EventoTable",!1)}).always(function(){CargarAlertas(frmEvento)}),!1}function SelEdicionEvento(n){$("#idEdicionEvento").val(n)}function EliminarEdicionEvento(){var n=$("#idEdicionEvento").val();$.post("/Evento/EliminarEdicionEvento",{EdicionEventoId:n}).success(function(n){n.IsEverythingGood==!0?ReloadTable("EventoTable",!1):n.IsRedirect}).always(function(){CargarAlertas(frmEvento)})}function InicializarCombosAndCkeditorEdicionEvento(){InicializarCKEDITOR("EdicionEvento_Header_en");InicializarCKEDITOR("EdicionEvento_Content_en");InicializarCKEDITOR("EdicionEvento_Meta_description_en");InicializarCKEDITOR("EdicionEvento_Header_es");InicializarCKEDITOR("EdicionEvento_Content_es");InicializarCKEDITOR("EdicionEvento_Meta_description_es");var n=JSON.parse("["+$("#hAreasPracticas"+frmModal).val()+"]"),t=JSON.parse("["+$("#hAutores"+frmModal).val()+"]"),i=JSON.parse("["+$("#hSpeakers"+frmModal).val()+"]"),r=$("#hImagenPosY"+frmModal).val(),u=$("#hEvento"+frmModal).val();new Combo({name:"AreasPracticas",view:frmModal,actionController:"/AreaPractica/LlenarAreasPracticas/",selectValue:n}).createBasicCombo();new Combo({name:"Autores",view:frmModal,actionController:"/Profesional/LlenarProfesionales/",selectValue:t}).createBasicCombo();new Combo({name:"Speakers",view:frmModal,actionController:"/Profesional/LlenarComboSpeakers/",selectValue:i}).createBasicCombo();new Combo({name:"ImagenPosY",view:frmModal,actionController:"/Articulo/LlenarComboPosImg/",cantItems:1,selectValue:r}).createBasicCombo();new Combo({name:"Evento",view:frmModal,actionController:"/Evento/LlenarComboEvento/",cantItems:1,selectValue:u}).createBasicCombo()}function AltaEdicionEvento(){ModalEdicionEvento(null)}function ModalEdicionEvento(n){$("#dialog").load("/Evento/ModalEdicionEvento",{IdEdicionEvento:n},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmEvento)})}function ModalAdjuntoEvento(n){$("#dialog").load("/Evento/ModalAdjuntoEvento",{IdEdicionEvento:n},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmEvento)})}function ValidEvento(){return $("#EventoCombo").is(":checked")&&$("#hEventoModal").val()!=""||$("#EdicionEvento_NuevoEvento").is(":checked")&&$("#EventoTxt").val()!=""?!0:(Danger("El campo Evento es obligatorio."),!1)}function GuardarEdicionEvento(){if($("#divFormatoFotoIncorrecto").addClass("hidden"),ValidarArchivo("principalPicture",formatosImagenesValidas)&&ValidarArchivo("footerPicture",formatosImagenesValidas)&&ValidarArchivo("inputStrCalendario",formatoCalendar)&&ValidarArchivo("inputStrCalendarioEn",formatoCalendar)&&ValidarArchivo("fileAgenda",formatoPdf))if($("#principalPicture").val()!=""){if(ValidEvento())if($("#EdicionEvento_Header_en").val(CKEDITOR.instances.EdicionEvento_Header_en.getData()),$("#EdicionEvento_Content_en").val(CKEDITOR.instances.EdicionEvento_Content_en.getData()),$("#EdicionEvento_Meta_description_en").val(CKEDITOR.instances.EdicionEvento_Meta_description_en.getData()),$("#EdicionEvento_Header_es").val(CKEDITOR.instances.EdicionEvento_Header_es.getData()),$("#EdicionEvento_Content_es").val(CKEDITOR.instances.EdicionEvento_Content_es.getData()),$("#EdicionEvento_Meta_description_es").val(CKEDITOR.instances.EdicionEvento_Meta_description_es.getData()),$("#EdicionEventoForm").valid()){$("#btnGuardarEvento").button("loading");var n=new FormData($("#EdicionEventoForm")[0]);$.ajax({url:"/Evento/GuardarEdicionEvento",type:"POST",data:n,cache:!1,contentType:!1,processData:!1}).success(function(n){n.IsEverythingGood==!0?(ReloadTable("EventoTable",!0),$("#dialog").modal("hide")):n.IsRedirect}).always(function(){$("#btnGuardarEvento").button("reset");CargarAlertas(frmModal)})}else Danger("No se cumplió la validación del formulario, por favor verifique el mismo.")}else Danger("La edición del evento debe tener una imágen pricipal sin excepción.");else Danger("Corrobore que los formatos de los archivos adjuntos sean los correctos.");return!1}function BorrarPicturePrincipal(){BorrarInputFile("inputFilePicture");$("#imgPicture").attr("src","/Images/imgNoDisp.png");$("#imgPicture").attr("title","Imagen no disponible");$("#divFormatoIncorrecto").addClass("hidden")}function BorrarPictureFooter(){BorrarInputFile("inputFilePictureFooter");$("#imgPictureFooter").attr("src","/Images/imgNoDisp.png");$("#imgPictureFooter").attr("title","Imagen no disponible");$("#divFormatoIncorrectoFooter").addClass("hidden")}function BorrarLinkES(){BorrarInputFile("inputStrCalendario")}function BorrarLinkEN(){BorrarInputFile("inputStrCalendarioEn")}function ObtenerOrigenes(){$.ajax({type:"GET",url:"/Evento/ObtenerContenidoOrigen"}).done(function(n){n.forEach(function(n){$("<option>",{value:n.IdOrigenContenido,text:n.Origen}).appendTo("#select-origenes")})}).fail().always(function(){CargarAlertas(frmModal)})}function CargarLinks(){$.ajax({type:"GET",url:"/Evento/ObtenerContenidos",data:{idEventoEdicion:$("#EventoContenido_EdicionEvento_id").val()}}).done(function(n){var t="";n.forEach(function(n){t+='<div class="row" style="margin-top: 1%">                         <div class="col-md-12">                             <button id="'+n.Id+'" onclick="BorrarContenido(this.id)" class="borrarContenido btn btn-sm btn-danger" style="margin-right: 1%;">                                 <span style="margin-left: 1%" class="glyphicon glyphicon-remove" aria-hidden="true"><\/span>                             <\/button>                             <a href="'+n.Url+'" target="_blank">'+n.Url+"<\/a>                         <\/div>                     <\/div> "});$("#cargarLinks").empty();$("#cargarLinks").html(t);VistaCarga(!1)})}function GuardarContenido(){($("#EventoContenido_IdOrigenContenido").val($("#select-origenes").val()),$("#formContenido").valid())&&(VistaCarga(!0),$.ajax({type:"POST",url:"/Evento/GuardarContenido",data:$("#formContenido").serialize()}).done(function(n){n.IsEverythingGood&&($("#formContenido")[0].reset(),CargarLinks())}).fail(function(){VistaCarga(!1)}).always(function(){CargarAlertas(frmEvento)}))}function BorrarContenido(n){VistaCarga(!0);$.ajax({type:"POST",url:"/Evento/BorrarContenido",data:{idContenido:n}}).done(function(){CargarLinks()}).fail(function(){VistaCarga(!1)}).always(function(){CargarAlertas(frmEvento)})}function VistaCarga(n){n?$("#loading-overlay").css("display","block"):$("#loading-overlay").css("display","none")}function CambiarNombreArchivoAgenda(){var n=$("#fileAgenda").val().split("\\").pop();$("#inputArchivoAgenda").val(n)}function BorrarArchivoAgenda(){$("#fileAgenda").val(null);$("#inputArchivoAgenda").val(null)}function ModalAgenda(n){$("#dialog").load("/Evento/ModalAgenda",{idEdicionEvento:n},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmEvento)})}function CargarAgenda(){$.ajax({type:"GET",url:"/Evento/ObtenerAgendas",data:{idEvento:$("#EventoAgenda_IdEdicionEvento").val()}}).done(function(n){var i="",t;n.agenda.length>0&&$("#cargarAgenda").html('                                    <table class= "table" >                                    <thead>                                        <tr>                                            <th>Titulo<\/th>                                            <th>Fecha<\/th>                                            <th>Hora<\/th>                                            <th><\/th>                                        <\/tr>                                    <\/thead>                                    <tbody id="tablaModalAgenda">                                    <\/tbody>                                <\/table >');n.agenda.forEach(function(n){i+='<tr id="ag-'+n.Id+'">                        <td>'+n.TituloEs+"<\/td>                        <td>"+n.Fecha+"<\/td>                        <td>"+n.Hora+'<\/td>                        <td class="text-end" style="display:flex; align-items: end; justify-content: end;">                            <button type="button" style="float: left; margin-right: 1%;" class="btn btn-default btn-xs" title="Editar" onclick="EditarAgenda('+n.Id+');">                                 <span class="glyphicon glyphicon-edit" aria-hidden="true"><\/span>                             <\/button>                             <button type="button" style="float: left; margin-right: 1%;" class="btn btn-default btn-xs btn-danger" onclick="EliminarAgenda('+n.Id+')" data-toggle="confirmation" data-placement="left" data-singleton="true" data-on-confirm="EliminarEdicionEvento" data-title="¿Está seguro?">                                 <span class="glyphicon glyphicon-remove" aria-hidden="true"><\/span>                             <\/button>                        <\/td>                    <\/tr>'});t=$("#tablaModalAgenda");t.empty();t.html(i)}).fail().always(function(){CargarAlertas(frmEvento)})}function EliminarAgenda(n){$("#ag-"+n).css("display","none");$.ajax({type:"POST",url:"/Evento/BorrarAgenda",data:{idAgenda:n}}).done(function(){}).fail().always(function(){CargarAlertas(frmEvento)})}function EditarAgenda(n){$.ajax({type:"GET",url:"/Evento/ObtenerAgenda",data:{idAgenda:n}}).done(function(n){$("#dialog").animate({scrollTop:0},"slow");n.EventoAgenda.Idioma=="es"?$('select option[value="es"]').attr("selected",!0):n.EventoAgenda.Idioma=="en"&&$('select option[value="en"]').attr("selected",!0);$("#EventoAgenda_Idioma").val(n.EventoAgenda.Idioma);$("#EventoAgenda_IdEdicionEvento").val(n.EventoAgenda.IdEdicionEvento);$("#EventoAgenda_Fecha").val(n.EventoAgenda.Fecha);$("#EventoAgenda_Hora").val(n.EventoAgenda.Hora);$("#EventoAgenda_TituloEs").val(n.EventoAgenda.TituloEs);$("#EventoAgenda_TituloEn").val(n.EventoAgenda.TituloEn);$("#EventoAgenda_Id").val(n.EventoAgenda.Id);$("#Modo").val(n.Modo);$("#btnEnviar").text("Guardar");CKEDITOR.instances.EventoAgenda_ContenidoEs.setData(n.EventoAgenda.ContenidoEs);CKEDITOR.instances.EventoAgenda_ContenidoEn.setData(n.EventoAgenda.ContenidoEn)}).fail(function(){CargarAlertas(frmEvento)})}function GuardarAgenda(){($("#EventoAgenda_Idioma").val($("#idiomas").val()),$("#EventoAgenda_ContenidoEn").val(CKEDITOR.instances.EventoAgenda_ContenidoEn.getData()),$("#EventoAgenda_ContenidoEs").val(CKEDITOR.instances.EventoAgenda_ContenidoEs.getData()),$("#AgendaForm").valid())&&$.ajax({type:"POST",url:"/Evento/GuardarAgenda",data:$("#AgendaForm").serialize()}).done(function(){VaciarForm();CargarAgenda()}).fail().always(function(){CargarAlertas(frmEvento)})}function VaciarForm(){var n=$("#EventoAgenda_Fecha"),t=n.val();$("#AgendaForm")[0].reset();CKEDITOR.instances.EventoAgenda_ContenidoEs.setData("");CKEDITOR.instances.EventoAgenda_ContenidoEn.setData("");$("select option").attr("selected",!1);n.val(t);$("#Modo").val("ALTA");$("#btnEnviar").text("Agregar")}function ModalContenidoExtra(n){$("#dialog").load("/Evento/ModalContenidoExtra",{idEvento:n},function(n,t){t=="success"?$("#dialog").modal("show"):CargarAlertas(frmEvento)})}function CambiarImageVideo(n){$("#typeVideo").addClass("hidden");$("#typeImg").addClass("hidden");n=="imagen"?($("#typeImg").removeClass("hidden"),$("#typeVideo").addClass("hidden")):n=="video"&&($("#typeImg").addClass("hidden"),$("#typeVideo").removeClass("hidden"))}function GuardarContenidoExtra(){var t,n,i;if(ValidarArchivo("EventoContenidoExtra_NombreArchivoImagen",formatosImagenesValidas)&&$("#formContenidoExtra").valid()){if($("#EventoContenidoExtra_UrlVideo").val()==""&&$("#EventoContenidoExtra_NombreArchivoImagen").val()==""){t='<p class="text-danger"> El campo es obligatorio <\/p>';n=$(".validacionContenidoExtraForm");n.empty();n.html(t);return}VistaCarga(!0);$("#EventoContenidoExtra_TipoContenido").val($("#select-contenido").val());i=new FormData($("#formContenidoExtra")[0]);$.ajax({type:"POST",url:"/Evento/GuardarContenidoExtra",data:i,cache:!1,contentType:!1,processData:!1}).done(function(){VaciarInputs();CargarTablaContenidoExtra($("#EventoContenidoExtra_EdicionEvento_id").val())}).fail().always(function(){VistaCarga(!1);CargarAlertas(frmEvento)})}}function CargarTablaContenidoExtra(n){$.ajax({type:"GET",url:"/Evento/ObtenerContenidoExtra",data:{idEvento:n}}).done(function(n){var i="",t;n.forEach(function(n){var t;n.UrlVideo!=null?t='<a target="_blank" href="'+n.UrlVideo+'">'+n.UrlVideo+"<\/a>":n.NombreArchivoImagen!=null&&(t=n.NombreArchivoImagen);i+='<div class="row" style="margin-top: 1%">                         <div class="col-md-12">                             <button id="'+n.Id+'" onclick="EliminarContenidoExtra(this.id)" class="borrarContenido btn btn-sm btn-danger" style="margin-right: 1%;">                                 <span style="margin-left: 1%" class="glyphicon glyphicon-remove" aria-hidden="true"><\/span>                             <\/button>                             '+t+"                        <\/div>                     <\/div> "});t=$("#cargaContenidoExtra");t.empty();t.html(i)})}function VaciarInputs(){$("#imgPicture").attr("src","/Images/imgNoDisp.png");$("#EventoContenidoExtra_UrlVideo").val("");$("#EventoContenidoExtra_NombreArchivoImagen").val("");$("#EventoContenidoExtra_PictureUpload").val("");$(".validacionContenidoExtraForm").empty()}function EliminarContenidoExtra(n){$.ajax({type:"POST",url:"/Evento/EliminarContenidoExtra",data:{idContenidoExtra:n}}).done(function(n){n.IsEverythingGood&&CargarTablaContenidoExtra($("#EventoContenidoExtra_EdicionEvento_id").val())}).always(function(){CargarAlertas(frmEvento)})}var frmEvento="Evento",frmModal="Modal",formatosImagenesValidas=["jpg","jpeg","png","bmp"],formatoPdf=["pdf"],formatoCalendar=["ics"];