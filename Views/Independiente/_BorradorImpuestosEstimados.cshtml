

@{ }


<div id="Alerts_BorradorImpuestosEstimados"></div>

<div class="row mb-3">
    <div class="col-md-12">
        @{
            if (ViewBag.TipoProceso == 1)
            {
                <h3>Borrador impuestos estimados (Proceso Real)</h3>
            }
            else
            {
                <h3 style="color:#ff6a00">Borrador impuestos estimados (Proceso Provisorio)</h3>
            }
        }
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-12">
        <p class="leyenda">Ingrese los impuestos anuales estimados para cada socio.</p>
    </div>
</div>

<div class="row">
    <div class="col-md-1"></div>
    <div class="col-md-4">
        <label>Excel importes</label>
        <div class="custom-file">

            <input type="file" class="custom-file-input" name="excelFile" id="excelFile" accept=".xls, .xlsx" lang="es">
            <label class="custom-file-label" for="customFileLang">Seleccionar Archivo</label>
        </div>
        <div> <a href="~/Templates/CargaImpuestosBorrador.xlsx" target="_blank">Descargar Template</a></div>
    </div>
    <div class="col-md-1">
        <div>
            <button id="btnCargarExcel" type="button" class="btn btn-primary btn-sm" style="margin-top:30px;" onclick="ValidarDatosExcelBorradorImpuestos()">Cargar</button>
        </div>
    </div>
    <div class="col-md-3"></div>
   
</div>

<form id="BorradorImpuestosEstimadosForm" onsubmit="GuardarBorradorImpuestosEstimados(); return false;">


    <div class="row mt-3">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <table id="ImpuestosEstimadosBorradorTable" class="table">
                <thead class="thead-dark">
                    <tr>
                        <th width="20%" scope="col">Socio/Ex-Socio</th>
                        <th width="11%" scope="col">Anticipos<br />Bienes<br />Personales</th>
                        <th width="11%" scope="col">Saldo DDJJ<br />Bienes<br />Personales</th>
                        <th width="11%" scope="col">Anticipos<br />Impuestos<br />Ganancias</th>
                        <th width="11%" scope="col">Saldo DDJJ<br />Ganancias</th>
                        <th width="11%" scope="col">Impuesto<br />Cedular</th>
                        <th width="11%" scope="col">Saldo DDJJ<br />Impuesto<br />Cedular</th>
                        <th width="14%">Total</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody></tbody>
                @*<tbody>
                    @{
                        // Totales de los SOCIOS
                        int Importe_TotalAnticiposImpuestosGananciasSocios = Model.Socios.Sum(item => item.ImporteGanancias);
                        int Importe_TotalAnticiposBienesPersonalesSocios = Model.Socios.Sum(item => item.ImporteBienesPersonales);
                        int Importe_TotalSaldoDDJJBienesPersonalesSocios = Model.Socios.Sum(item => item.ImporteSaldoDDJJBienes);
                        int Importe_TotalSaldoDDJJGananciasSocios = Model.Socios.Sum(item => item.ImporteSaldoDDJJGanancias);
                        int Importe_TotalSaldoDDJJImpuestoCedularSocios = Model.Socios.Sum(item => item.ImporteSaldoDDJJCedular);
                        int Importe_TotalImpuestoCedularSocios = Model.Socios.Sum(item => item.ImporteImpuestoCedular);
                        int TotalSocios = Model.Socios.Sum(item => item.Total);


                        // Totales de los ExSocios
                        int Importe_TotalAnticiposImpuestosGananciasExSocios = Model.ExSocios.Sum(item => item.ImporteGanancias);
                        int Importe_TotalAnticiposBienesPersonalesExSocios = Model.ExSocios.Sum(item => item.ImporteBienesPersonales);
                        int Importe_TotalSaldoDDJJBienesPersonalesExSocios = Model.ExSocios.Sum(item => item.ImporteSaldoDDJJBienes);
                        int Importe_TotalSaldoDDJJGananciasExSocios = Model.ExSocios.Sum(item => item.ImporteSaldoDDJJGanancias);
                        int Importe_TotalSaldoDDJJImpuestoCedularExSocios = Model.ExSocios.Sum(item => item.ImporteSaldoDDJJCedular);
                        int Importe_TotalImpuestoCedularExSocios = Model.ExSocios.Sum(item => item.ImporteImpuestoCedular);
                        int TotalExSocios = Model.ExSocios.Sum(item => item.Total);



                        //----- Suma de los totales

                        int SumaTotalAnticiposImpuestosGanancias = Importe_TotalAnticiposImpuestosGananciasSocios + Importe_TotalAnticiposImpuestosGananciasExSocios;
                        int SumaTotalAnticiposBienesPersonales = Importe_TotalAnticiposBienesPersonalesSocios + Importe_TotalAnticiposBienesPersonalesExSocios;
                        int SumaTotalSaldoDDJJBienesPersonales = Importe_TotalSaldoDDJJBienesPersonalesSocios + Importe_TotalSaldoDDJJBienesPersonalesExSocios;
                        int SumaTotalSaldoDDJJGanancias = Importe_TotalSaldoDDJJGananciasSocios + Importe_TotalSaldoDDJJGananciasExSocios;
                        int SumaTotalSaldoDDJJImpuestoCedular = Importe_TotalSaldoDDJJImpuestoCedularSocios + Importe_TotalSaldoDDJJImpuestoCedularExSocios;
                        int SumaTotalImpuestoCedular = Importe_TotalImpuestoCedularSocios + Importe_TotalImpuestoCedularExSocios;
                        int SumaTotal = TotalSocios + TotalExSocios;

                        if (Model.Socios.Count > 0)
                        {
                            for (int i = 0; i < Model.Socios.Count; i++)
                            {
                                <tr id="@Model.Socios[i].IdPersona" data-type="Socio" data-row="@i">
                                    <td>@Model.Socios[i].Socio</td>

                                    <td>
                                        <div id="ImporteBienesPersonales_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteBienesPersonales">
                                            $ @Model.Socios[i].ImporteBienesPersonales.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJBienes_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteSaldoDDJJBienes">
                                            $ @Model.Socios[i].ImporteSaldoDDJJBienes.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteGanancias_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteGanancias">
                                            $ @Model.Socios[i].ImporteGanancias.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJGanancias_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteSaldoDDJJGanancias">
                                            $ @Model.Socios[i].ImporteSaldoDDJJGanancias.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteImpuestoCedular_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteImpuestoCedular">
                                            $ @Model.Socios[i].ImporteImpuestoCedular.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJCedular_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].ImporteSaldoDDJJCedular">
                                            $ @Model.Socios[i].ImporteSaldoDDJJCedular.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteTotal_@Model.Socios[i].IdPersona" data-val="@Model.Socios[i].Total">
                                            $ @Model.Socios[i].Total.ToString("N0")
                                        </div>
                                    </td>

                                    <td style="text-align: right">
                                        <button type="button" class="btn btn-light btn-xs ml-1" data-id="" onClick="ModalEdicionImpuestos('@Model.Socios[i].IdPersona'); return false;" title="Editar datos">
                                            <span class="fas fa-pen" aria-hidden="true"></span>
                                        </button>
                                    </td>
                                </tr>
                            }
                        }


                        <tr id="totalSocios" class="bg-total">
                            <td>Total Socios</td>
                            <td>
                                <div id="Importe_TotalAnticiposBienesPersonalesSocios" data-val="@Importe_TotalAnticiposBienesPersonalesSocios">
                                    $ @Importe_TotalAnticiposBienesPersonalesSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJBienesPersonalesSocios" data-val="@Importe_TotalSaldoDDJJBienesPersonalesSocios">
                                    $ @Importe_TotalSaldoDDJJBienesPersonalesSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalAnticiposImpuestosGananciasSocios" data-val="@Importe_TotalAnticiposImpuestosGananciasSocios">
                                    $ @Importe_TotalAnticiposImpuestosGananciasSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJGananciasSocios" data-val="@Importe_TotalSaldoDDJJGananciasSocios">
                                    $ @Importe_TotalSaldoDDJJGananciasSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalImpuestoCedularSocios" data-val="@Importe_TotalImpuestoCedularSocios">
                                    $ @Importe_TotalImpuestoCedularSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJImpuestoCedularSocios" data-val="@Importe_TotalSaldoDDJJImpuestoCedularSocios">
                                    $ @Importe_TotalSaldoDDJJImpuestoCedularSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSocios" data-val="@TotalSocios">
                                    $ @TotalSocios.ToString("N0")
                                </div>
                            </td>
                            <td></td>
                        </tr>
                        //--------------------------------------------------------------------------------
                        if (Model.ExSocios.Count > 0)
                        {

                            for (int i = 0; i < Model.ExSocios.Count; i++)
                            {
                                <tr id="@Model.ExSocios[i].IdPersona" data-type="ExSocio" data-row="@i">
                                    <td>@Model.ExSocios[i].Socio</td>

                                    <td>
                                        <div id="ImporteBienesPersonales_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteBienesPersonales">
                                            $ @Model.ExSocios[i].ImporteBienesPersonales.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJBienes_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteSaldoDDJJBienes">
                                            $ @Model.ExSocios[i].ImporteSaldoDDJJBienes.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteGanancias_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteGanancias">
                                            $ @Model.ExSocios[i].ImporteGanancias.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJGanancias_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteSaldoDDJJGanancias">
                                            $ @Model.ExSocios[i].ImporteSaldoDDJJGanancias.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteImpuestoCedular_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteImpuestoCedular">
                                            $ @Model.ExSocios[i].ImporteImpuestoCedular.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteSaldoDDJJCedular_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].ImporteSaldoDDJJCedular">
                                            $ @Model.ExSocios[i].ImporteSaldoDDJJCedular.ToString("N0")
                                        </div>
                                    </td>

                                    <td>
                                        <div id="ImporteTotal_@Model.ExSocios[i].IdPersona" data-val="@Model.ExSocios[i].Total">
                                            $ @Model.ExSocios[i].Total.ToString("N0")
                                        </div>
                                    </td>

                                    <td style="text-align: right">
                                        <button type="button" class="btn btn-light btn-xs ml-1" data-id="" onClick="ModalEdicionImpuestos('@Model.ExSocios[i].IdPersona'); return false;" title="Editar datos">
                                            <span class="fas fa-pen" aria-hidden="true"></span>
                                        </button>
                                    </td>
                                </tr>
                            }
                        }

                        <tr id="totalExSocios" class="bg-total">
                            <td>Total ExSocios</td>

                            <td>
                                <div id="Importe_TotalAnticiposBienesPersonalesExSocios" data-val="@Importe_TotalAnticiposBienesPersonalesExSocios">
                                    $ @Importe_TotalAnticiposBienesPersonalesExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJBienesPersonalesExSocios" data-val="@Importe_TotalSaldoDDJJGananciasExSocios">
                                    $ @Importe_TotalSaldoDDJJGananciasExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalAnticiposImpuestosGananciasExSocios" data-val="@Importe_TotalAnticiposImpuestosGananciasExSocios">
                                    $ @Importe_TotalAnticiposImpuestosGananciasExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJGananciasExSocios" data-val="@Importe_TotalSaldoDDJJGananciasExSocios">
                                    $ @Importe_TotalSaldoDDJJGananciasExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalImpuestoCedularExSocios" data-val="@Importe_TotalImpuestoCedularExSocios">
                                    $ @Importe_TotalImpuestoCedularExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalSaldoDDJJImpuestoCedularExSocios" data-val="@Importe_TotalSaldoDDJJImpuestoCedularExSocios">
                                    $ @Importe_TotalSaldoDDJJImpuestoCedularExSocios.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="Importe_TotalExSocios" data-val="@TotalExSocios">
                                    $ @TotalExSocios.ToString("N0")
                                </div>
                            </td>
                            <td></td>
                        </tr>


                        <tr class="bg-totalGeneral">
                            <td>TOTAL</td>

                            <td>
                                <div id="SumaTotalAnticiposBienesPersonales">
                                    $ @SumaTotalAnticiposBienesPersonales.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="SumaTotalSaldoDDJJBienesPersonales">
                                    $ @SumaTotalSaldoDDJJBienesPersonales.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="SumaTotalAnticiposImpuestosGanancias">
                                    $ @SumaTotalAnticiposImpuestosGanancias.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="SumaTotalSaldoDDJJGanancias" data-val="@SumaTotalSaldoDDJJGanancias">
                                    $ @SumaTotalSaldoDDJJGanancias.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="SumaTotalImpuestoCedular">
                                    $ @SumaTotalImpuestoCedular.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="SumaTotalSaldoDDJJImpuestoCedular" data-val="@SumaTotalSaldoDDJJImpuestoCedular">
                                    $ @SumaTotalSaldoDDJJImpuestoCedular.ToString("N0")
                                </div>
                            </td>

                            <td>
                                <div id="ImporteSumaTotal" data-val="@SumaTotal">
                                    $ @SumaTotal.ToString("N0")
                                </div>
                            </td>
                            <td></td>
                        </tr>
                    }
                </tbody>*@
            </table>
        </div>
        <div class="col-md-1"></div>
    </div>

    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="text-center">
                <button type="submit" id="btnGuardarBorrador" class="btn btn-primary btn-sm pl-3 pr-3 mt-5">Guardar</button>
            </div>
        </div>
        <div class="col-md-1"></div>

    </div>
</form>

<partial name="_ValidationScriptsPartial" />

<environment include="Development">
    <script src="~/js/BorradorImpuestosEstimados.js" asp-append-version="true"></script>
</environment>
<environment exclude="Development">
    <script src="~/js/BorradorImpuestosEstimados.min.js" asp-append-version="true"></script>
</environment>

<script type="text/javascript">

    $(document).ready(function () {

        CargarTabla(null)

        $('#excelFile').on('change',
            function (e) {
                //get the file name
                ;
                var fileName = e.target.files[0].name;

                //replace the "Choose a file" label
                $(this).next('.custom-file-label').html(fileName);
            })
    })

</script>
