function CargarBuscador(){$("#pnlBuscador").load("/Insights/Buscador",function(n,t){t=="success"})}function CargarContenidoInicial(){$("#NroPag").val(1);$("#pnlArticulosRecientes").load("/Insights/ContenidoInicialInsights",{tipoInsight:1},function(n,t){t=="success"&&$("#pnlDossiersRecientes").load("/Insights/ContenidoInicialInsights",{tipoInsight:2},function(n,t){t=="success"&&$("#pnlCasosRecientes").load("/Insights/ContenidoInicialInsights",{tipoInsight:3},function(n,t){t=="success"})})})}function InicializarCombosBusqueda(){var n=JSON.parse("["+$("#hAreas"+frmInsights).val()+"]"),t=JSON.parse("["+$("#hTipo"+frmInsights).val()+"]");const i=new Promise(t=>{new Combo({name:"Areas",view:frmInsights,actionController:"/AreasPracticas/ObtenerComboAreas/",myClass:"combo",selectValue:n,cantItems:1,callback:function(){refreshScrollbar();t()}}).createBasicCombo()}),r=new Promise(n=>{new Combo({name:"Tipo",view:frmInsights,actionController:"/Insights/ObtenerComboTipo/",myClass:"combo",selectValue:t,cantItems:1,callback:function(){n()}}).createBasicCombo()});Promise.all([i,r]).then(()=>{validarSearchParams()})}function validarSearchParams(){let n=localStorage.getItem("doSearch");n!="0"&&n!=null&&n!=""?(localStorage.setItem("doSearch",0),BuscarInsights()):CargarContenidoInicial()}async function BuscarInsights(n=1){const t=AnimacionBuscar();t.then(async()=>{let u=$("#ddlAreasInsights + .selectize-control .item").html(),f=$("#ddlTipoInsights + .selectize-control .item").html(),r=$("#Palabras").val(),e=$("#FechaDesde").val(),o=$("#FechaHasta").val(),t=$("#hProfesional"+frmInsights).val();t!=""&&t!=null&&t!=undefined&&(r=await ObtenerNombreProfesional(t));let i=[r??"",u??"",f??"",e??"",o??""];i=i.filter(n=>n!=="");let s=i.join(" - ");$("#nroResultados").html("...");$("#datosBusqueda").html(s);$("#NroPag").val(n);$("#pnlContenido").load("/Insights/ObtenerInsightsPorParams",$("#frmBusqueda"+frmInsights).serialize(),function(n,t){t=="success"})})}function ChangePagePagination(n){BuscarInsights(n);UpTo("#pnlContenido")}function VolverAlBuscador(){const n=AnimacionVolverAlBuscador();$("#pnlContenido").html("");$("#hProfesional"+frmInsights).val("");n.then(()=>{CargarContenidoInicial()})}function CargarProfesionales(n,t){$("#pnlProfesionales").load("/Profesionales/ProfesionalesInsights",{idInsight:n,tipo:t},function(n,t){t=="success"})}function CargarInsightsRelacionados(n,t){$("#pnlInsightsRel").load("/Insights/ObtenerInsightsRelPorArea",{tipoInsight:n,idArea:t},function(n,t){t=="success"})}function DescargarMaterial(){ComprobacionVisitanteId(SendDataUserLanding,"Insight")}function SendDataUserLanding(){$("#idVisitante").val(localStorage.userId);$.post("/Insights/DescargarMaterial",$("#FormDescarga").serialize()).done(function(n){n.IsEverythingGood==!0&&($("#FormDescarga").remove(),$(".pnlDescarga-detalle-insights").append(n.msj))}).always(function(){CargarAlertas()})}function ObtenerNombreProfesional(n){return new Promise((t,i)=>{$.ajax({type:"GET",url:"/Profesionales/ObtenerProfesional",data:{idProfesional:n},success:function(n){t(n)},error:function(n){i(n)}})})}function ModalDescargaDossier(n){$("#dialog-personalizado").load("/Insights/ModalDescargaDossier",{formId:n},function(n,t){t=="success"&&AbrirModalPersonalizado()})}function EscucharInsights(n){let i=$(n).data("play");if(i){audio.pause();$(n).find(".pause").addClass("d-none");$(n).find(".palabra-detener").addClass("d-none");$(n).find(".headphones").removeClass("d-none");$(n).find(".palabra-escuchar").removeClass("d-none");$(n).data("play",!1);return}if($(n).find(".pause").removeClass("d-none"),$(n).find(".palabra-detener").removeClass("d-none"),$(n).find(".headphones").addClass("d-none"),$(n).find(".palabra-escuchar").addClass("d-none"),$(n).data("play",!0),audio!=undefined&&!audio.ended){audio.play();return}let r=$(".contenido-titulo").text().trim()+".",u=$(".contenido-copete").text().trim()+".",f=$(".contenido-description").text().trim(),e=r+"\n"+u+"\n"+f,t=$(".boton-escuchar button");t.addClass("desactivado");$.ajax({url:"/Home/ObtenerAudio",method:"POST",xhrFields:{responseType:"blob"},data:{text:e.trim()},success:function(i){i.size==0&&($(n).find(".pause").addClass("d-none"),$(n).find(".palabra-detener").addClass("d-none"),$(n).find(".headphones").removeClass("d-none"),$(n).find(".palabra-escuchar").removeClass("d-none"),$(n).data("play",!1));t.removeClass("desactivado");var r=new Blob([i],{type:"audio/mpeg"}),u=window.URL.createObjectURL(r);audio=new Audio(u);audio.play();audio.addEventListener("ended",function(){$(n).find(".pause").addClass("d-none");$(n).find(".palabra-detener").addClass("d-none");$(n).find(".headphones").removeClass("d-none");$(n).find(".palabra-escuchar").removeClass("d-none");$(n).data("play",!1)})}})}var frmInsights="Insights",audio=undefined;