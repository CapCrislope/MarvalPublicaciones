@model DistribucionUtilidades.Models.VM.CargaBonosYRetirosVM


<div id="Alerts_CargaBonosYRetiros"></div>

<div class="row mb-3">
    <div class="col-md-12">
        @{
            if (ViewBag.TipoProceso == 1)
            {
                <h3>Carga de Bonos y Retiros (Proceso Real)</h3>
            }
            else
            {
                <h3 style="color:#ff6a00">Carga de Bonos y Retiros (Proceso Provisorio)</h3>
            }
        }
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-12">
        @{
            if (ViewBag.TipoProceso == 1)
            {
                <p class="leyenda">
                    Cargue el archivo de Excel con la información correspondiente a los Bonos y Retiros.<br />
                    Recuerde que tiene disponible un modelo del archivo. Para verlo, haga clic en “Excel de Bonos y Retiros”.
                </p>
            }
            else
            {
                <p class="leyenda">
                    Cargue el archivo de Excel con la información estimada de los Bonos y Retiros.<br />
                    Recuerde que tiene disponible un modelo del archivo. Para verlo, haga clic en “Excel de Bonos y Retiros”.
                </p>
            }
        }
    </div>
</div>


@{ if (Model.Modo == "EDICION")
    {
        <div class="row mt-3 mb-4">
            <div class="col-md-1"></div>
            <div class="form-group-sm col-md-4" style="color: #db2121; font-size: 16px;">
                <label>Nota de Revisión</label>
                @{if (Model.NotaRevision != "" && Model.NotaRevision != null)
                    {
                        <div>@Model.NotaRevision</div>
                    }
                    else
                    {
                        <div>-</div>
                    }


                }

            </div>
            <div class="col-md-7"></div>
        </div>
    }
}

        <form id="formImport" enctype="multipart/form-data" method="post">
            @Html.HiddenFor(model => model.Modo)
            <div class="row">

                <div class="col-md-1"></div>
                <div class="col-md-4">
                    <label>Excel de bonos y retiros</label>
                    <div class="custom-file">

                        <input type="file" class="custom-file-input" name="excelFile" id="excelFile" accept=".xls, .xlsx" lang="es">
                        <label class="custom-file-label" for="customFileLang">Seleccionar Archivo</label>
                    </div>
                </div>

                <div class="col-md-2">
                    <div>
                        <button id="btnCargarExcel" type="button" class="btn btn-primary btn-sm" style="margin-top:30px;" onclick="ValidarDatosExcel();">Cargar</button>
                    </div>

                </div>
                <div class="col-md-4">

                </div>

            </div>
            <div class="row mt-1">
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <a href="/Templates/BonosRetiros.xlsx" target="_blank">Descargar Template</a>
                </div>
                <div class="col-md-1"></div>
            </div>
        </form>


        <div class="row mt-5">
            <div class="col-md-1"></div>
            <div class="col-md-10">

                <table id="BonosYRetirosTable" class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th width="35%" scope="col">Socio</th>
                            <th width="35%" scope="col">Bonos</th>
                            <th width="35%">Retiro</th>
                        </tr>
                    </thead>
                    <tbody>
                            <tr>
                                <td></td>
                                <td style="text-align:center;">No hay registros cargados.</td>
                                <td></td>
                            </tr>
                   </tbody>
                </table>
            </div>
            <div class="col-md-1"></div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div>
                    <button type="button" id="btnGuardarImportes" class="btn btn-primary btn-sm mx-auto d-block pl-3 pr-3 mt-5" onclick="GuardarImportesBonosYRetiros();" disabled>Guardar</button>
                </div>
            </div>

        </div>


<partial name="_ValidationScriptsPartial" />

<environment include="Development">
    <script src="~/js/CargaBonosYRetiros.js" asp-append-version="true"></script>
</environment>
<environment exclude="Development">
    <script src="~/js/CargaBonosYRetiros.min.js" asp-append-version="true"></script>
</environment>

<script type="text/javascript">

    $(document).ready(function () {
        $('#excelFile').on('change',
            function (e) {
                //get the file name
                ;
                var fileName = e.target.files[0].name;

                //replace the "Choose a file" label
                $(this).next('.custom-file-label').html(fileName);
            })

    })

</script>