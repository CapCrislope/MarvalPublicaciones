function ValidarDatosExcel(){if($("#btnCargarExcel").prop("disabled",!0),$("#excelFile")[0].files[0]!=null){var n=new FormData;n.append("file",$("#excelFile")[0].files[0]);$.ajax({type:"POST",url:"/RRHH/ValidarDatosExcel",data:n,cache:!1,contentType:!1,processData:!1,success:function(n){CargarAlertas(frmHome);n.isEverythingGood&&(drawItemTable(n.lista,n.sumBonos,n.sumRetiros),$("#btnGuardarImportes").prop("disabled",!1))},error:function(){CargarAlertas(frmHome)},complete:function(){$("#formImport")[0].reset();$(".custom-file-label").html("Seleccionar Archivo");$("#btnCargarExcel").prop("disabled",!1)}})}else Danger("Debe cargar un archivo."),$("#btnCargarExcel").prop("disabled",!1)}function drawItemTable(n,t,i){var u,r;for($("#BonosYRetirosTable > tbody").empty(),u="",r=0;r<n.length;r++)u+=' <tr id="'+n[r].personaId+'" data-type="Socio">        <td>'+n[r].socio+'<\/td>        <td><div id="ImporteBono_'+n[r].personaId+'" data-value="'+n[r].bono+'">$ '+n[r].bono.toLocaleString()+'<\/div>        <\/td>        <td><div id="ImporteRetiro_'+n[r].personaId+'" data-value="'+n[r].retiro+'">$ '+n[r].retiro.toLocaleString()+"<\/div><\/td>    <\/tr>";u+='<tr id="totalBonosRetiros" class="table-info">                            <td>Total<\/td>                            <td><div>$ '+t.toLocaleString()+"<\/div>                            <\/td>                            <td><div> $ "+i.toLocaleString()+"<\/div><\/td>                        <\/tr>";$("#BonosYRetirosTable tbody").append(u)}function ObjPersona(){return{PersonaId:null,Retiro:null,Bono:null}}function GetDataSociosYExSocios(){var n=[];return $("#BonosYRetirosTable tbody tr[data-type='Socio']").each(function(t,i){var r=ObjPersona(),u=i.id,f=$("#ImporteBono_"+i.id).attr("data-value"),e=$("#ImporteRetiro_"+i.id).attr("data-value");r.PersonaId=u;r.Bono=f;r.Retiro=e;n.push(r)}),n}function GuardarImportesBonosYRetiros(){var n=GetDataSociosYExSocios(),t=$("#Modo").val();$.post("/RRHH/GuardarImporteBonosYRetiros",{Socios:n,Modo:t}).done(function(n){n.IsEverythingGood==!0&&(CargarMenu(),CargarEstadoProceso())}).always(function(){CargarAlertas(frmHome)})}