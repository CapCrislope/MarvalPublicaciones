function SumImportes(n){n.value==""&&$("#"+n.id).val("0");$("#TotalSocios").text("Calculando...");var t=0;return $("[id^= 'Importe_']").each(function(n,i){var r=$("#"+i.id).val();t=t+parseInt(r)}),$("#TotalSocios").text("$ "+t.toLocaleString()),t}function GuardarGastosViajes(){var n={Socios:GetDataSociosImporte(),Modo:$("#Modo").val()};$.post("/RRHH/GuardarGastosViajes",{cvm:n}).done(function(n){n.isEverythingGood==!0&&(CargarMenu(),CargarEstadoProceso())}).always(function(){CargarAlertas(frmHome)})}function ObjPersona(){return{IdPersona:null,Importe:null}}function GetDataSociosImporte(){var n=[];return $("#GastosViajesTable tbody tr[data-type='Socio']").each(function(t,i){var r=ObjPersona();r.IdPersona=i.id;r.Importe=$("#Importe_"+i.id).val();n.push(r)}),n}function CargaDataTablaGastosViajes(n,t){$("#GastosViajesTable tbody").load("/RRHH/CargarTablaGastosViajes",{Modo:n,Lista:t},function(n,t){t=="success"&&$("input[type=number]").politespace()})}function ValidarDatosExcelGastosViajes(){if($("#btnCargarExcel").prop("disabled",!0),$("#excelFile")[0].files[0]!=null){var n=new FormData;n.append("file",$("#excelFile")[0].files[0]);$.ajax({type:"POST",url:"/RRHH/ValidarDatosExcelGastosViajes",data:n,cache:!1,contentType:!1,processData:!1,success:function(n){CargarAlertas(frmHome);n.isEverythingGood&&CargaDataTablaGastosViajes("EXCEL",n.lista);$("#btnCargarExcel").prop("disabled",!1)},error:function(){CargarAlertas(frmHome);$("#btnCargarExcel").prop("disabled",!1)},complete:function(){$(".custom-file-label").html("Seleccionar Archivo");$("#btnCargarExcel").prop("disabled",!1)}})}else Danger("Debe cargar un archivo."),$("#btnCargarExcel").prop("disabled",!1)}